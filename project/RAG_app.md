

ğŸ¤– RAG ë¬¸ì„œ ê¸°ë°˜ ì±—ë´‡ (Streamlit + Chroma) - ì‘ì„±ì¼: 2026-01-28 ì˜¤ì§€ìˆ˜


# 1ï¸âƒ£ í”„ë¡œì íŠ¸ êµ¬ì„±

- `data/` : PDF ë¬¸ì„œ(ì˜ˆ : `2040_report.pdf` ë“±)                    
- `chroma_db/` : ë²¡í„°DB ì €ì¥ ê²½ë¡œ(persist)
- `build_db.py` : PDF â†’ chunk â†’ embedding â†’ Chroma ì €ì¥           
- `app.py` : Streamlit ì±—ë´‡ UI + RAG ì§ˆì˜ì‘ë‹µ

# 2ï¸âƒ£ Streamlit RAG ê¸°ë³¸ ë™ì‘(ì‹¤ìŠµ1)

- í™˜ê²½ë³€ìˆ˜ ë¡œë“œ : `.env` â†’ `OPENAI_API_KEY`
- ì„ë² ë”© : `text-embedding-3-small`
- ë²¡í„°DB : `Chroma(persist_directory="chroma_db", collection="rag_docs")`
- ë¦¬íŠ¸ë¦¬ë²„ : `as_retriever(k=4)`
- ê²€ìƒ‰ ê²°ê³¼ë¥¼ `format_docs(docs)`ë¡œ ë¬¶ì–´ì„œ ì»¨í…ìŠ¤íŠ¸ë¡œ ì‚¬ìš©

# 3ï¸âƒ£ í™•ì¥ ê¸°ëŠ¥ 6ê°€ì§€(ì‹¤ìŠµ í™•ì¥ + ì‹¤ìŠµ2)

1) ì§ˆì˜ í™•ì¥(ì¬ì‘ì„± ì§ˆë¬¸)             `rewrite_chain`ìœ¼ë¡œ ì§ˆë¬¸ì„ â€œê²€ìƒ‰ ì¹œí™”ì â€ìœ¼ë¡œ 1ì¤„ ì¬ì‘ì„±
2) ë¦¬íŠ¸ë¦¬ë²„ í˜¸ì¶œ ê¸°ì¤€ ë³€ê²½            `retriever.invoke(user_q)` â†’ `retriever.invoke(expanded_q)`
3) ë‹µë³€ ê·œì¹™ ê°•í™”(í™˜ê° ë°©ì§€)           ì»¨í…ìŠ¤íŠ¸ì— ìˆëŠ” ë‚´ìš©ë§Œ ë‹µë³€ / ê·¼ê±° ì—†ìœ¼ë©´: `ë¬¸ì„œì—ì„œ í™•ì¸ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.` / í•­ëª©í˜• 6ì¤„ ì´ë‚´
4) ìŠ¤íŠ¸ë¦¬ë° ì¶œë ¥                     `ChatOpenAI(streaming=True)` / `answer_chain_stream.stream(...)` + `st.empty()`ë¡œ ì‹¤ì‹œê°„ ì¶œë ¥
5) ì¶œì²˜ í‘œê¸°(ì¤‘ë³µ ì œê±°)               `build_sources(docs)`ë¡œ `(source, page)` ì¤‘ë³µ ì œê±°
6) ë‹µë³€ ì•„ë˜ ì¶œì²˜ í…Œì´ë¸” ì¶œë ¥          `st.dataframe(sources, use_container_width=True)`ë¡œ í‘œì‹œ

# 4ï¸âƒ£ ì‹¤í–‰ ë°©ë²•

1) `.env`ì— `OPENAI_API_KEY=...` ì„¤ì •
2) (ì²˜ìŒ 1íšŒ) `python build_db.py`  â†’ `chroma_db/` ìƒì„±
3) `streamlit run app.py`

# 5ï¸âƒ£ í™•ì¸ìš© ì§ˆë¬¸ ì˜ˆì‹œ(ì„±ê³µ íŒ¨í„´)

- `2040_report.pdfì—ì„œ ìˆ«ìë‚˜ í†µê³„ê°€ í¬í•¨ëœ ë¬¸ì¥ì„ ê·¸ëŒ€ë¡œ ì¸ìš©í•´ì¤˜`
- `2040_report.pdfì—ì„œ ê¸°ìˆ  ë°œì „ ê´€ë ¨ ë‚´ìš©ì´ ìˆëŠ” ë¶€ë¶„ì„ ìš”ì•½í•´ì¤˜`
   (ì¬ì‘ì„± ì§ˆë¬¸ í‘œì‹œ + ë‹µë³€ ìŠ¤íŠ¸ë¦¬ë° + ì¶œì²˜ í…Œì´ë¸” ì¶œë ¥ì´ë©´ ì •ìƒ)